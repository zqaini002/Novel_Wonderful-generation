"use strict";(self["webpackChunknovel_assistant_frontend"]=self["webpackChunknovel_assistant_frontend"]||[]).push([[376],{2376:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});a(4114);var l=a(6768),r=a(4232),n=a(144),s=a(1387),u=a(1219),o=a(7477),i=a(3339);const d={class:"visualization-container"},c={class:"card-header"},v={key:0,class:"loading-container"},p={key:1},g={class:"pagination-container"};var b={__name:"VisualizationView",setup(e){const t=(0,s.rd)(),a=(0,n.KR)(!0),b=(0,n.KR)([]),k=(0,n.KR)(0),f=(0,n.KR)(1),h=(0,n.KR)(10),w=async()=>{a.value=!0;try{const e=await i.A.getAllNovels();e&&e.novels?(b.value=e.novels,k.value=e.total||e.novels.length):(b.value=[],k.value=0,console.warn("获取小说列表返回格式异常"))}catch(e){console.error("获取小说列表失败:",e),u.nk.error("获取小说列表失败: "+(e.message||"未知错误")),b.value=[],k.value=0}finally{a.value=!1}},y=()=>{w()},m=e=>{if(!e)return"未知";const t=new Date(e);return t.toLocaleString()},_=e=>{switch(e){case"COMPLETED":return"success";case"PROCESSING":return"warning";case"FAILED":return"danger";case"PENDING":return"info";default:return"info"}},D=e=>{switch(e){case"COMPLETED":return"已完成";case"PROCESSING":return"处理中";case"FAILED":return"处理失败";case"PENDING":return"等待处理";default:return"未知状态"}},L=e=>"COMPLETED"===e,F=e=>{t.push(`/admin/novel/${e}/visualization`)},E=e=>{f.value=e,w()},A=e=>{h.value=e,w()};return(0,l.sV)((()=>{w()})),(e,t)=>{const s=(0,l.g2)("el-button"),u=(0,l.g2)("el-skeleton"),i=(0,l.g2)("el-alert"),f=(0,l.g2)("el-table-column"),w=(0,l.g2)("el-tag"),C=(0,l.g2)("el-icon"),I=(0,l.g2)("el-popover"),z=(0,l.g2)("el-table"),$=(0,l.g2)("el-pagination"),R=(0,l.g2)("el-card");return(0,l.uX)(),(0,l.CE)("div",d,[(0,l.bF)(R,{class:"visualization-card"},{header:(0,l.k6)((()=>[(0,l.Lk)("div",c,[t[1]||(t[1]=(0,l.Lk)("h2",null,"小说可视化分析",-1)),(0,l.bF)(s,{type:"primary",onClick:y},{default:(0,l.k6)((()=>t[0]||(t[0]=[(0,l.eW)("刷新数据")]))),_:1})])])),default:(0,l.k6)((()=>[a.value?((0,l.uX)(),(0,l.CE)("div",v,[(0,l.bF)(u,{rows:10,animated:""})])):((0,l.uX)(),(0,l.CE)("div",p,[0===b.value.length?((0,l.uX)(),(0,l.Wv)(i,{key:0,title:"暂无小说数据",type:"info","show-icon":"",closable:!1},{default:(0,l.k6)((()=>t[2]||(t[2]=[(0,l.eW)(" 系统中目前没有可供可视化分析的小说数据 ")]))),_:1})):((0,l.uX)(),(0,l.Wv)(z,{key:1,data:b.value,border:"",style:{width:"100%"}},{default:(0,l.k6)((()=>[(0,l.bF)(f,{prop:"id",label:"ID",width:"80"}),(0,l.bF)(f,{prop:"title",label:"小说标题","min-width":"200"}),(0,l.bF)(f,{prop:"author",label:"作者",width:"150"}),(0,l.bF)(f,{prop:"totalChapters",label:"章节数",width:"100"}),(0,l.bF)(f,{prop:"status",label:"状态",width:"120"},{default:(0,l.k6)((e=>[(0,l.bF)(w,{type:_(e.row.status)},{default:(0,l.k6)((()=>[(0,l.eW)((0,r.v_)(D(e.row.status)),1)])),_:2},1032,["type"])])),_:1}),(0,l.bF)(f,{prop:"createTime",label:"上传时间",width:"180"},{default:(0,l.k6)((e=>[(0,l.eW)((0,r.v_)(m(e.row.createTime)),1)])),_:1}),(0,l.bF)(f,{label:"操作",width:"300"},{default:(0,l.k6)((e=>[(0,l.bF)(s,{type:"primary",size:"small",onClick:t=>F(e.row.id),disabled:!L(e.row.status)},{default:(0,l.k6)((()=>[(0,l.bF)(C,null,{default:(0,l.k6)((()=>[(0,l.bF)((0,n.R1)(o.ja0))])),_:1}),t[3]||(t[3]=(0,l.eW)(" 可视化分析 "))])),_:2},1032,["onClick","disabled"]),(0,l.bF)(I,{placement:"top",width:"200",trigger:"hover"},{reference:(0,l.k6)((()=>[(0,l.bF)(s,{size:"small",type:"info",disabled:!L(e.row.status)},{default:(0,l.k6)((()=>[(0,l.bF)(C,null,{default:(0,l.k6)((()=>[(0,l.bF)((0,n.R1)(o.N_H))])),_:1}),t[4]||(t[4]=(0,l.eW)(" 详情 "))])),_:2},1032,["disabled"])])),default:(0,l.k6)((()=>[t[5]||(t[5]=(0,l.Lk)("div",{class:"visualization-popover-content"},[(0,l.Lk)("p",null,[(0,l.Lk)("b",null,"可视化内容包括：")]),(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,"关键词云图"),(0,l.Lk)("li",null,"情节波动图"),(0,l.Lk)("li",null,"人物关系网络"),(0,l.Lk)("li",null,"小说结构分析"),(0,l.Lk)("li",null,"章节情感分析")])],-1))])),_:2},1024)])),_:1})])),_:1},8,["data"])),(0,l.Lk)("div",g,[(0,l.bF)($,{background:"",layout:"prev, pager, next, sizes, total",total:k.value,"page-size":h.value,"page-sizes":[10,20,50,100],onSizeChange:A,onCurrentChange:E},null,8,["total","page-size"])])]))])),_:1})])}}},k=a(1241);const f=(0,k.A)(b,[["__scopeId","data-v-0a9f7ea0"]]);var h=f},3339:function(e,t,a){var l=a(412);const r={async getDashboardStats(){return l.A.get("/admin/dashboard")},async getAllUsers(){return l.A.get("/admin/users")},async getUserDetail(e){if(!e)throw new Error("用户ID不能为空");return l.A.get(`/admin/users/${e}`)},async updateUserStatus(e,t){if(!e)throw new Error("用户ID不能为空");return l.A.put(`/admin/users/${e}/status`,{enabled:t})},async updateUserInfo(e,t){if(!e)throw new Error("用户ID不能为空");return l.A.put(`/admin/users/${e}`,t)},async deleteUser(e){if(!e)throw new Error("用户ID不能为空");return l.A.delete(`/admin/users/${e}`)},async getAllNovels(){return l.A.get("/admin/novels")},async deleteNovel(e){if(!e)throw new Error("小说ID不能为空");return l.A.delete(`/admin/novels/${e}`)},async getSystemLogs(e=0,t=20,a={}){let r=`/admin/logs?page=${e}&size=${t}`;return a.level&&"ALL"!==a.level&&(r+=`&level=${a.level}`),a.startDate&&(r+=`&startDate=${a.startDate}`),a.endDate&&(r+=`&endDate=${a.endDate}`),a.query&&(r+=`&query=${encodeURIComponent(a.query)}`),a.userId&&(r+=`&userId=${String(a.userId)}`),console.log("系统日志请求URL:",r),l.A.get(r)},async clearSystemCache(){return l.A.post("/admin/cache/clear")}};t.A=r}}]);